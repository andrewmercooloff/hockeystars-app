# Обновление базы данных Supabase

## Проблема
В приложении отсутствуют некоторые поля в базе данных, что приводит к тому, что данные не сохраняются и не отображаются правильно:
- `favorite_goals` - любимые голы (видео)
- `photos` - фотографии пользователя
- `number` - номер игрока

## Решение

### 1. Выполните SQL-скрипт в Supabase

1. Откройте панель управления Supabase
2. Перейдите в раздел "SQL Editor"
3. Создайте новый запрос
4. Скопируйте и вставьте содержимое файла `database/add_missing_columns.sql`
5. Нажмите "Run" для выполнения скрипта

### 2. Проверьте результат

После выполнения скрипта в таблице `players` должны появиться новые колонки:
- `favorite_goals` (TEXT)
- `photos` (TEXT) 
- `number` (VARCHAR(10))

### 3. Перезапустите приложение

После обновления базы данных перезапустите приложение, чтобы изменения вступили в силу.

## Что было исправлено

1. **Добавлены недостающие поля в интерфейсы TypeScript**:
   - `SupabasePlayer` - интерфейс для данных из базы
   - `Player` - интерфейс для приложения

2. **Обновлены функции преобразования данных**:
   - `convertSupabaseToPlayer` - правильно парсит JSON для фотографий
   - `convertPlayerToSupabase` - правильно сериализует массивы

3. **Исправлена функция обновления**:
   - `updatePlayer` - теперь сохраняет все поля, включая новые

4. **Добавлена обработка ошибок**:
   - Безопасный парсинг JSON для фотографий
   - Проверка на пустые массивы

## Результат

После выполнения этих изменений:
- ✅ Аватары будут отображаться правильно
- ✅ Фотографии будут сохраняться и отображаться
- ✅ Видео (любимые голы) будут работать
- ✅ Номер игрока будет сохраняться
- ✅ Все физические данные и нормативы будут синхронизироваться
- ✅ Данные между личным кабинетом и главным экраном будут синхронизированы 